{"version":3,"sources":["../../src/server/next.ts"],"names":["NextServer","ServerImpl","getServerImpl","undefined","Promise","resolve","require","default","SYMBOL_SET_STANDALONE_MODE","Symbol","SYMBOL_LOAD_CONFIG","constructor","options","hostname","port","standaloneMode","getRequestHandler","req","res","parsedUrl","getTracer","trace","NextServerSpan","requestHandler","getServerRequestHandler","getUpgradeHandler","socket","head","server","getServer","handleUpgrade","apply","setAssetPrefix","assetPrefix","preparedAssetPrefix","logError","args","render","renderToHTML","renderError","renderErrorToHTML","render404","serveStatic","prepare","dev","close","createServer","ServerImplementation","preloadedConfig","loadConfig","PHASE_DEVELOPMENT_SERVER","PHASE_PRODUCTION_SERVER","dir","conf","_renderWorker","serverPromise","then","process","env","__NEXT_PRIVATE_STANDALONE_CONFIG","JSON","stringify","output","log","warn","Error","reqHandler","reqHandlerPromise","wrap","bind","typescript","createTSPlugin","NODE_ENV","includes","NON_STANDARD_NODE_ENV","console","customServer","shouldUseStandaloneMode","createServerHandler","handlerPromise","Proxy","get","_","propKey","config","distDir","NEXT_RUNTIME","join","serverDistDir","SERVER_DIRECTORY","hasAppDir","findDir","minimalMode","handler","standaloneHandler","pathname","query","url","formatUrl","method","module","exports"],"mappings":"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"}