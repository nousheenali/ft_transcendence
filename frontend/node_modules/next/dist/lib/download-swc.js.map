{"version":3,"sources":["../../src/lib/download-swc.ts"],"names":["downloadNativeNextSwc","downloadWasmSwc","fetch","require","WritableStream","MAX_VERSIONS_TO_CACHE","getCacheDirectory","result","envDefined","process","env","systemCacheDirectory","platform","XDG_CACHE_HOME","path","join","os","homedir","LOCALAPPDATA","dir","tmpdir","fileExists","console","error","Error","exit","isAbsolute","resolve","cwd","extractBinary","outputDirectory","pkgName","tarFileName","cacheDirectory","extractFromTar","tar","x","file","strip","Log","info","fs","promises","mkdir","recursive","tempFile","Date","now","registry","getRegistry","then","res","ok","body","status","cacheWriteStream","createWriteStream","pipeTo","write","chunk","close","rename","cacheFiles","readdir","length","sort","a","b","localeCompare","i","unlink","catch","version","bindingsDirectory","triplesABI","triple","substring","wasmDirectory","variant"],"mappings":"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"}